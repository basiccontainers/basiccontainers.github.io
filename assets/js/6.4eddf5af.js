(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{402:function(e,t,a){e.exports=a.p+"assets/img/applicationInsights.f72f63c1.png"},403:function(e,t,a){e.exports=a.p+"assets/img/instrumentconfig.3bcc21ac.png"},404:function(e,t,a){e.exports=a.p+"assets/img/applicationInsights_nav.252b63ed.png"},405:function(e,t,a){e.exports=a.p+"assets/img/javaappdeployment.0582227c.png"},422:function(e,t,a){"use strict";a.r(t);var o=a(46),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"deploy-java-application-to"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#deploy-java-application-to"}},[e._v("#")]),e._v(" Deploy java application to")]),e._v(" "),o("p",[e._v("Azure App Service provides a highly scalable, self-patching web hosting service. This lab shows how to use the Azure CLI with the Azure Web App Plugin for Maven to deploy a .jar file, or .war file. Use the tabs to switch between Java SE and Tomcat instructions.")]),e._v(" "),o("h2",{attrs:{id:"_1-clone-project"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_1-clone-project"}},[e._v("#")]),e._v(" 1 Clone project")]),e._v(" "),o("p",[e._v("Clone the Spring Boot Getting Started sample project.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("git clone https://github.com/spring-guides/gs-spring-boot\n")])])]),o("h2",{attrs:{id:"_2-prepare-maven-project"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_2-prepare-maven-project"}},[e._v("#")]),e._v(" 2 Prepare maven project")]),e._v(" "),o("p",[e._v("Run the Maven command below to configure the deployment. This command will help you to set up the App Service operating system, Java version, and Tomcat version.")]),e._v(" "),o("ul",[o("li",[e._v("first navigate to the project folder")])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("cd gs-spring-boot/complete\n")])])]),o("ul",[o("li",[e._v("Execute the following command. This will start a wizard to configure the maven plugin automatically.")])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("mvn com.microsoft.azure:azure-webapp-maven-plugin:2.2.0:config\n")])])]),o("ul",[o("li",[e._v("When prompted with Subscription option, select the proper Subscription by entering the number printed at the line start.")]),e._v(" "),o("li",[e._v("When prompted with Web App option, select the default option, "),o("create",[e._v(", by pressing enter.")])],1),e._v(" "),o("li",[e._v("When prompted with OS option, select Linux by pressing enter.")]),e._v(" "),o("li",[e._v("When prompted with javaVersion option, select Java 8 by entering 1.")]),e._v(" "),o("li",[e._v("When prompted with Pricing Tier option, select P1v2 by entering 9.")]),e._v(" "),o("li",[e._v("Finally, press enter on the last prompt to confirm your selections.")]),e._v(" "),o("li",[e._v("You can modify the pom file directly by modifying the following properties in that are injected into the pom file")])]),e._v(" "),o("table",[o("thead",[o("tr",[o("th",[e._v("Property")]),e._v(" "),o("th",[e._v("Required")]),e._v(" "),o("th",[e._v("Description")]),e._v(" "),o("th",[e._v("Version")])])]),e._v(" "),o("tbody",[o("tr",[o("td",[e._v("schemaVersion")]),e._v(" "),o("td",[e._v("false")]),e._v(" "),o("td",[e._v("Specify the version of the configuration schema. Supported values are: v1, v2.")]),e._v(" "),o("td",[e._v("1.5.2")])]),e._v(" "),o("tr",[o("td",[e._v("subscriptionId")]),e._v(" "),o("td",[e._v("false")]),e._v(" "),o("td",[e._v("Specify the subscription ID.")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("resourceGroup")]),e._v(" "),o("td",[e._v("true")]),e._v(" "),o("td",[e._v("Azure Resource Group for your Web App.")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("appName")]),e._v(" "),o("td",[e._v("true")]),e._v(" "),o("td",[e._v("The name of your Web App.")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("region")]),e._v(" "),o("td",[e._v("false")]),e._v(" "),o("td",[e._v("Specifies the region where your Web App will be hosted; the default value is centralus. All valid regions at Supported Regions section.")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("pricingTier")]),e._v(" "),o("td",[e._v("false")]),e._v(" "),o("td",[e._v("The pricing tier for your Web App. The default value is P1v2 for production workload, while B2 is the recommended minimum for Java dev/test. Learn more")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("runtime")]),e._v(" "),o("td",[e._v("false")]),e._v(" "),o("td",[e._v("The runtime environment configuration, you could see the detail here.")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("deployment")]),e._v(" "),o("td",[e._v("false")]),e._v(" "),o("td",[e._v("The deployment configuration, you could see the details here.")]),e._v(" "),o("td",[e._v("0.1.0+")])]),e._v(" "),o("tr",[o("td",[e._v("You can modify the configurations for App Service directly in your pom.xml if needed. Some common ones are listed below:")]),e._v(" "),o("td"),e._v(" "),o("td"),e._v(" "),o("td")])])]),e._v(" "),o("h3",{attrs:{id:"inspect-pom-xml"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#inspect-pom-xml"}},[e._v("#")]),e._v(" Inspect pom.xml")]),e._v(" "),o("p",[e._v("To view the changes the maven plugin made. Open the pom.xml under gs-spring-boot/complete/pom-xml  "),o("code",[e._v("code pom.xml")]),e._v(". and under the build section")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("      <plugin>\n        <groupId>com.microsoft.azure</groupId>\n        <artifactId>azure-webapp-maven-plugin</artifactId>\n        <version>2.2.0</version>\n        <configuration>\n          <schemaVersion>v2</schemaVersion>\n          <subscriptionId>yxxxxxx</subscriptionId>\n          <resourceGroup>spring-boot-complete-xxxx-rg</resourceGroup>\n          <appName>spring-boot-complete-xxxxx</appName>\n          <pricingTier>P1v2</pricingTier>\n          <region>centralus</region>\n          <runtime>\n            <os>Linux</os>\n            <javaVersion>Java 8</javaVersion>\n            <webContainer>Java SE</webContainer>\n          </runtime>\n          <deployment>\n            <resources>\n              <resource>\n                <directory>${project.basedir}/target</directory>\n                <includes>\n                  <include>*.jar</include>\n                </includes>\n              </resource>\n            </resources>\n          </deployment>\n        </configuration>\n      </plugin>\n")])])]),o("h2",{attrs:{id:"_3-deploy-java-to-cloud"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_3-deploy-java-to-cloud"}},[e._v("#")]),e._v(" 3 Deploy java to cloud")]),e._v(" "),o("p",[e._v("With all the configuration ready in your pom file, you can deploy your Java app to Azure with one single command.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("mvn package azure-webapp:deploy\n")])])]),o("p",[e._v("Navigate to the azure portal and open the open the application url to verify the deployment was successful.")]),e._v(" "),o("h3",{attrs:{id:"deploy-application-with-zip-deploy"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#deploy-application-with-zip-deploy"}},[e._v("#")]),e._v(" Deploy application with zip deploy")]),e._v(" "),o("p",[e._v("Another approach to test is simply deploying the .jar file. https://docs.microsoft.com/en-us/azure/app-service/deploy-zip?tabs=cli#deploy-a-zip-package")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("az webapp deploy --resource-group spring-boot-complete-1634050788447-rg --name spring-boot-complete-1634050788447  --src-path  spring-boot-complete-0.0.1-SNAPSHOT.jar --type jar\n")])])]),o("h2",{attrs:{id:"_5-bonus-challenge-enable-application-insights-and-monitoring"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_5-bonus-challenge-enable-application-insights-and-monitoring"}},[e._v("#")]),e._v(" 5 Bonus challenge : Enable application insights and monitoring")]),e._v(" "),o("p",[e._v("In this lab you should enable application tracing and monitoring with AppInisghts.")]),e._v(" "),o("ul",[o("li",[e._v("Go to the java based app service")]),e._v(" "),o("li",[e._v("Select application insights from the app services menu")]),e._v(" "),o("li",[e._v("Select enable\n"),o("img",{attrs:{src:a(402),alt:"registry"}})]),e._v(" "),o("li",[e._v("Ensure the workspace location is in the same region as the AppService (westeurope)")]),e._v(" "),o("li",[e._v("Apply the following instrumentation configuration\n"),o("ul",[o("li",[e._v("https://docs.microsoft.com/en-us/azure/azure-monitor/app/java-standalone-config#an-example")]),e._v(" "),o("li",[e._v("Ensure a Role.name is configured in the config")]),e._v(" "),o("li",[e._v("remove the connectionString and any preview features from the config (the portal will warn you)\n"),o("img",{attrs:{src:a(403),alt:"registry"}})])])]),e._v(" "),o("li",[e._v("Once onboarded generated some traffic on the application")]),e._v(" "),o("li",[e._v("Navigate to application insights once the configuration is applied and explore the data collected. (start from application app)\n"),o("img",{attrs:{src:a(404),alt:"insights"}})])]),e._v(" "),o("p",[e._v("https://azure.microsoft.com/de-de/updates/public-preview-easily-onboard-application-insights-for-java-apps-on-azure-app-services/")]),e._v(" "),o("p",[e._v("https://azure.microsoft.com/de-de/updates/public-preview-easily-onboard-application-insights-for-java-apps-on-azure-app-services/")]),e._v(" "),o("h2",{attrs:{id:"_6-bonus-set-up-continuous-deployment-for-java"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_6-bonus-set-up-continuous-deployment-for-java"}},[e._v("#")]),e._v(" 6 Bonus: Set up continuous deployment for java")]),e._v(" "),o("p",[e._v('Simialr to previous lab  we can configure Continous deployment via the "deploymen center"\nhttps://docs.microsoft.com/en-us/azure/app-service/deploy-continuous-deployment?tabs=github')]),e._v(" "),o("p",[e._v("Hints")]),e._v(" "),o("ul",[o("li",[e._v("in github fork the repo")]),e._v(" "),o("li",[e._v('Go to "deployment center" and configure your github as source repo\n'),o("img",{attrs:{src:a(405),alt:"registry"}})]),e._v(" "),o("li",[e._v("you may need to make changes to the generate to work flow file .yaml file to ensure\n"),o("ul",[o("li",[e._v("the mvn package script is executed in the correct folder")]),e._v(" "),o("li",[e._v("the .jar artifact is copyed to the next stage")])])])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("\n      - name: Build with Maven\n        run: mvn clean install\n        working-directory: '${{ github.workspace }}/complete'\n      \n    \n      - name: Upload artifact for deployment job\n        uses: actions/upload-artifact@v2\n        with:\n          name: java-app\n          path: '${{ github.workspace }}/complete/target/*.jar'\n")])])]),o("p",[e._v("https://docs.microsoft.com/en-us/azure/app-service/deploy-continuous-deployment?tabs=github")])])}),[],!1,null,null,null);t.default=n.exports}}]);